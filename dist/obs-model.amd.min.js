/*! obs-model 0.4.0 Copyright (c) 2013 Alan Plum. MIT licensed. */define(function(e,t){function s(e,t){function s(e){e=e||{},this._destructors=[];var t={},n={},s,o,u;for(s in this.model.attrs)o=this.model.attrs[s]||{},o.write||o.read?(this[s]=r.computed({lazy:o.lazy,write:o.write,read:o.read?i:o.read,context:this}),o.read&&(t[s]=o.read),o.watch&&(n[s]=[].concat(o.watch))):e.hasOwnProperty(s)?this[s]=r.prop(e[s]):this[s]=r.prop();for(s in t)this[s].read=t[s];for(s in n)for(u=0;u<n[s].length;u++)this[s].watch(this[n[s][u]]);this._destructors.push(function(){for(var e in n)for(var t=0;t<n[e].length;t++)this[e].unwatch(this[n[e][t]])});for(u=0;u<this.model.plugins.length;u++)this.model.plugins[u](this)}return s.prototype={model:s,dismiss:function(){for(var e=0;e<this._destructors.length;e++)this._destructors[e].call(this)}},n(s,{modelName:e,attrs:t||{},plugins:[],attr:function(e,t){return this.attrs[e]=t,this},use:function(e){for(var t=0;t<this.plugins.length;t++)if(this.plugins[t]===e)return this;return typeof e.contributeToModel=="function"&&e.contributeToModel(this),this.plugins.push(e),this}}),s}var n=e("assimilate"),r=e("obs"),i=function(){};t.model=s});