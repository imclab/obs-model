/*! obs-model 0.5.0 Copyright (c) 2013 Alan Plum. MIT licensed. @preserve */
!function(t){var i=function(i){return t[i]},r={};var s=i("aug"),o=i("obs"),e=function(){};function n(t,i){function r(t){t=t||{};this._destructors=[];var i={};var r={};var s,n,h;for(s in this.model.attrs){n=this.model.attrs[s]||{};if(n.write||n.read){this[s]=o.computed({lazy:n.lazy,write:n.write,read:n.read?e:n.read,context:this});if(n.read){i[s]=n.read}if(n.watch){r[s]=[].concat(n.watch)}}else if(t.hasOwnProperty(s)){this[s]=o.prop(t[s])}else{this[s]=o.prop()}}for(s in i){this[s].read=i[s]}for(s in r){for(h=0;h<r[s].length;h++){this[s].watch(this[r[s][h]])}}this._destructors.push(function(){for(var t in r){for(var i=0;i<r[t].length;i++){this[t].unwatch(this[r[t][i]])}}});for(h=0;h<this.model.plugins.length;h++){this.model.plugins[h](this)}}r.prototype={model:r,dismiss:function(){for(var t=0;t<this._destructors.length;t++){this._destructors[t].call(this)}}};s(r,{modelName:t,attrs:i||{},plugins:[],attr:function(t,i){this.attrs[t]=i;return this},use:function(t){for(var i=0;i<this.plugins.length;i++){if(this.plugins[i]===t){return this}}if(typeof t.contributeToModel==="function"){t.contributeToModel(this)}this.plugins.push(t);return this}});return r}r.exports=n;t.obsModel=r.exports}(this);